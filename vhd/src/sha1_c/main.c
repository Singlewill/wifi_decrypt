#include <stdio.h>
#include <stdlib.h>

#include "sha1-internal.h"

int main()
{
	int i;
	const unsigned char* addr[6];
	unsigned char mac[20];
	size_t len[6];
	unsigned char ch56[] = {
		0x61, 0x62, 0x63, 0x64, 0x62, 0x63, 0x64, 0x65,
		0x63, 0x64, 0x65, 0x66, 0x64, 0x65, 0x66, 0x67,
		0x65, 0x66, 0x67, 0x68, 0x66, 0x67, 0x68, 0x69,
		0x67, 0x68, 0x69, 0x6a, 0x68, 0x69, 0x6a, 0x6b,
		0x69, 0x6a, 0x6b, 0x6c, 0x6a, 0x6b, 0x6c, 0x6d,
		0x6b, 0x6c, 0x6d, 0x6e, 0x6c, 0x6d, 0x6e, 0x6f,
		0x6d, 0x6e, 0x6f, 0x70, 0x6e, 0x6f, 0x70, 0x71
	};
	unsigned char ch57[] = {
		0x61, 0x62, 0x63, 0x64, 0x62, 0x63, 0x64, 0x65,
		0x63, 0x64, 0x65, 0x66, 0x64, 0x65, 0x66, 0x67,
		0x65, 0x66, 0x67, 0x68, 0x66, 0x67, 0x68, 0x69,
		0x67, 0x68, 0x69, 0x6a, 0x68, 0x69, 0x6a, 0x6b,
		0x69, 0x6a, 0x6b, 0x6c, 0x6a, 0x6b, 0x6c, 0x6d,
		0x6b, 0x6c, 0x6d, 0x6e, 0x6c, 0x6d, 0x6e, 0x6f,
		0x6d, 0x6e, 0x6f, 0x70, 0x6e, 0x6f, 0x70, 0x71,
		0x55
	};
	unsigned char ch64[] = {
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37
	};

	addr[0] = ch64;
	len[0] = sizeof(ch64);

	addr[1] = ch64;
	len[1] = sizeof(ch64);

	addr[2] = ch57;
	len[2] = sizeof(ch57);

	printf("sizeof len is %d\n", len[0]);
	int ret;
	ret = sha1_vector(3, addr, len, mac);
	if (ret == -1){
		printf("sha1_vector failed..\n");
		return -1;
	}





	printf("sha1 calc result is :\n");
	for (i = 0; i < 20; i++) {
		printf("0x%02x ", mac[i]);
		if (i%8 == 7)
			printf("\n");
	}
	printf("\n");
	return 0;
}
